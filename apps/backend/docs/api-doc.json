{
  "openapi": "3.0.4",
  "info": {
    "title": "مُختصِر - واجهة برمجة التطبيقات الخاصة بمُختصِر",
    "description": "هذه هي مواصفات واجهة برمجة التطبيقات لمُختصِر التي تتيح لك الوصول برمجياً إلى خدمتنا لتحويل الروابط الطويلة إلى روابط مختصرة\n\nالميزات:\n- إنشاء روابط مختصرة (مع أو بدون أسماء مستعارة مخصصة)\n- تحديث وحذف الروابط المختصرة\n- تتبع الإحصائيات الأساسية (النقرات، المرجع، إلخ)\n",
    "contact": {
      "email": "support@mukhtasar.pro"
    },
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://api.mukhtasar.pro/api"
    }
  ],
  "tags": [
    {
      "name": "Url",
      "description": "الروابط المختصرة التي تعيد التوجيه إلى رابط أطول. تتيح لك نقاط النهاية هذه اختصار روابط جديدة وتعديل كيفية عملها"
    }
  ],
  "paths": {
    "/url": {
      "post": {
        "tags": [
          "Url"
        ],
        "summary": "إنشاء رابط مختصر جديد",
        "description": "تحويل رابط طويل إلى رابط مختصر جديد",
        "operationId": "createUrl",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "original_url": {
                    "type": "string",
                    "format": "uri",
                    "description": "الرابط الأصلي الطويل المراد اختصاره",
                    "example": "https://www.example.com/products/12354?utm_source=newsletter"
                  },
                  "alias": {
                    "type": "string",
                    "description": "اسم مستعار مخصص اختياري",
                    "example": "myexamplelink"
                  },
                  "domain": {
                    "type": "string",
                    "description": "النطاق المراد استخدامه للرابط المختصر",
                    "example": "mukhtasar.io"
                  },
                  "description": {
                    "type": "string",
                    "description": "وصف للرابط المختصر",
                    "example": "رابط صفحة المنتج"
                  }
                },
                "required": [
                  "original_url"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "تم إنشاء الرابط بنجاح",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "short_url": {
                          "type": "string",
                          "format": "uri",
                          "example": "https://mukhtasar.io/myexamplelink"
                        },
                        "alias": {
                          "type": "string",
                          "example": "myexamplelink"
                        },
                        "domain": {
                          "type": "string",
                          "example": "mukhtasar.io"
                        },
                        "original_url": {
                          "type": "string",
                          "format": "uri",
                          "example": "https://www.example.com/products/12354"
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-01-24T19:41:23+00:00"
                        }
                      }
                    },
                    "errors": {
                      "type": "array",
                      "items": {},
                      "example": []
                    },
                    "code": {
                      "type": "number",
                      "example": 0
                    },
                    "errorCode": {
                      "type": "string",
                      "example": "NO_ERROR"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "409": {
            "$ref": "#/components/responses/ConflictError"
          },
          "422": {
            "$ref": "#/components/responses/ValidationError"
          },
          "429": {
            "$ref": "#/components/responses/RateLimitExceeded"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/url/{domain}/{alias}": {
      "get": {
        "tags": [
          "Url"
        ],
        "summary": "استرداد معلومات الرابط المختصر",
        "description": "إرجاع تفاصيل الرابط المختصر، بما في ذلك الرابط الأصلي والنطاق والاسم المستعار والبيانات الوصفية الأخرى للنطاق والاسم المستعار المقدمين.\n",
        "operationId": "getShortUrlInfo",
        "parameters": [
          {
            "name": "alias",
            "in": "path",
            "description": "الاسم المستعار للرابط المختصر المراد البحث عنه",
            "required": true,
            "schema": {
              "type": "string",
              "example": "myalias123"
            }
          },
          {
            "name": "domain",
            "in": "path",
            "description": "نطاق الرابط المختصر المراد البحث عنه",
            "required": true,
            "schema": {
              "type": "string",
              "example": "mukhtasar.io"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "تم العثور على سجل الرابط المختصر",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "original_url": {
                          "type": "string",
                          "format": "uri",
                          "example": "https://www.example.com/blog/post?id=42"
                        },
                        "short_url": {
                          "type": "string",
                          "example": "https://mukhtasar.io/xYz123"
                        },
                        "alias": {
                          "type": "string",
                          "example": "xYz123"
                        },
                        "domain": {
                          "type": "string",
                          "example": "mukhtasar.io"
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-01-24T19:41:23+00:00"
                        },
                        "description": {
                          "type": "string",
                          "example": "رابط صفحة المنتج"
                        }
                      }
                    },
                    "errors": {
                      "type": "array",
                      "items": {},
                      "example": []
                    },
                    "code": {
                      "type": "number",
                      "example": 0
                    },
                    "errorCode": {
                      "type": "string",
                      "example": "NO_ERROR"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "405": {
            "$ref": "#/components/responses/MethodNotAllowed"
          },
          "422": {
            "$ref": "#/components/responses/ValidationError"
          },
          "429": {
            "$ref": "#/components/responses/RateLimitExceeded"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      },
      "patch": {
        "tags": [
          "Url"
        ],
        "summary": "تحديث الرابط الأصلي للرابط المختصر",
        "description": "يتيح تحديث الرابط الأصلي (الوجهة) لرابط مختصر موجود.",
        "operationId": "updateUrl",
        "parameters": [
          {
            "name": "alias",
            "in": "path",
            "description": "الاسم المستعار للرابط المختصر المراد تحديثه",
            "required": true,
            "schema": {
              "type": "string",
              "example": "myalias123"
            }
          },
          {
            "name": "domain",
            "in": "path",
            "description": "نطاق الرابط المختصر المراد تحديثه",
            "required": true,
            "schema": {
              "type": "string",
              "example": "mukhtasar.io"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "original_url": {
                    "type": "string",
                    "format": "uri",
                    "description": "الرابط الأصلي الجديد للتوجيه إليه",
                    "example": "https://www.example.com/new-destination"
                  }
                },
                "required": [
                  "original_url"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "تم تحديث الرابط بنجاح",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "url": {
                          "type": "string",
                          "format": "uri",
                          "example": "https://www.example.com/new-destination"
                        },
                        "alias": {
                          "type": "string",
                          "example": "myalias123"
                        },
                        "domain": {
                          "type": "string",
                          "example": "mukhtasar.io"
                        }
                      }
                    },
                    "errors": {
                      "type": "array",
                      "items": {},
                      "example": []
                    },
                    "code": {
                      "type": "number",
                      "example": 0
                    },
                    "errorCode": {
                      "type": "string",
                      "example": "NO_ERROR"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "422": {
            "$ref": "#/components/responses/ValidationError"
          },
          "429": {
            "$ref": "#/components/responses/RateLimitExceeded"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      },
      "delete": {
        "tags": [
          "Url"
        ],
        "summary": "حذف الرابط المختصر",
        "description": "حذف رابط مختصر بناءً على النطاق والاسم المستعار المقدمين.",
        "operationId": "deleteUrl",
        "parameters": [
          {
            "name": "alias",
            "in": "path",
            "description": "الاسم المستعار للرابط المختصر المراد حذفه",
            "required": true,
            "schema": {
              "type": "string",
              "example": "myalias123"
            }
          },
          {
            "name": "domain",
            "in": "path",
            "description": "نطاق الرابط المختصر المراد حذفه",
            "required": true,
            "schema": {
              "type": "string",
              "example": "mukhtasar.io"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "تم حذف الرابط بنجاح",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "description": "بيانات الاستجابة من عملية الحذف"
                    },
                    "errors": {
                      "type": "array",
                      "items": {},
                      "example": []
                    },
                    "code": {
                      "type": "number",
                      "example": 0
                    },
                    "errorCode": {
                      "type": "string",
                      "example": "NO_ERROR"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "422": {
            "$ref": "#/components/responses/ValidationError"
          },
          "429": {
            "$ref": "#/components/responses/RateLimitExceeded"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/url/{domain}/{alias}/count": {
      "get": {
        "tags": [
          "Url"
        ],
        "summary": "الحصول على عدد النقرات للرابط المختصر",
        "description": "إرجاع عدد المرات التي تم النقر فيها على الرابط المختصر",
        "operationId": "getUrlClickCounts",
        "parameters": [
          {
            "name": "alias",
            "in": "path",
            "description": "الاسم المستعار للرابط المختصر",
            "required": true,
            "schema": {
              "type": "string",
              "example": "myalias123"
            }
          },
          {
            "name": "domain",
            "in": "path",
            "description": "نطاق الرابط المختصر",
            "required": true,
            "schema": {
              "type": "string",
              "example": "mukhtasar.io"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "تم استرداد عدد النقرات بنجاح",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "alias": {
                          "type": "string",
                          "example": "myalias123"
                        },
                        "domain": {
                          "type": "string",
                          "example": "mukhtasar.io"
                        },
                        "clickCount": {
                          "type": "integer",
                          "example": 153
                        }
                      }
                    },
                    "errors": {
                      "type": "array",
                      "items": {},
                      "example": []
                    },
                    "code": {
                      "type": "number",
                      "example": 0
                    },
                    "errorCode": {
                      "type": "string",
                      "example": "NO_ERROR"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "422": {
            "$ref": "#/components/responses/ValidationError"
          },
          "429": {
            "$ref": "#/components/responses/RateLimitExceeded"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    }
  },
  "components": {
    "responses": {
      "UnauthorizedError": {
        "description": "غير مسموح لك بالوصول إلى هذا المورد.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "غير مسموح لك بتنفيذ هذا الإجراء على هذا المورد."
                  ]
                },
                "errorCode": {
                  "type": "string",
                  "example": "UNAUTHORIZED"
                },
                "code": {
                  "type": "number",
                  "example": 2
                }
              }
            }
          }
        }
      },
      "RateLimitExceeded": {
        "description": "عدد كبير من الطلبات — تم تجاوز الحد المسموح.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "لقد قمت بعدد كبير من الطلبات في وقت قصير. الرجاء الانتظار قليلاً ثم المحاولة مجددًا."
                  ]
                },
                "errorCode": {
                  "type": "string",
                  "example": "RATE_LIMIT_EXCEEDED"
                },
                "code": {
                  "type": "number",
                  "example": 5
                }
              }
            }
          }
        }
      },
      "MethodNotAllowed": {
        "description": "طريقة HTTP هذه غير مسموحة على نقطة النهاية هذه.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "طريقة الطلب (HTTP Method) غير مسموح بها على هذا المسار."
                  ]
                },
                "errorCode": {
                  "type": "string",
                  "example": "METHOD_NOT_ALLOWED"
                },
                "code": {
                  "type": "number",
                  "example": 2
                }
              }
            }
          }
        }
      },
      "ValidationError": {
        "description": "فشل في التحقق من إحدى الخصائص، يرجى التحقق من الأخطاء في نص الاستجابة.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "رابط غير صحيح",
                    "الاسم المستعار طويل جداً"
                  ]
                },
                "fieldErrors": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "example": {
                    "original_url": [
                      "تنسيق الرابط غير صحيح"
                    ],
                    "alias": [
                      "يجب أن يكون الاسم المستعار بين 1 و 20 حرف"
                    ]
                  }
                },
                "errorCode": {
                  "type": "string",
                  "example": "VALIDATION_ERROR"
                },
                "code": {
                  "type": "number",
                  "example": 3
                }
              }
            }
          }
        }
      },
      "InternalServerError": {
        "description": "خطأ داخلي في الخادم.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "حدث خطأ غير متوقع في الخادم. يرجى المحاولة لاحقًا."
                  ]
                },
                "errorCode": {
                  "type": "string",
                  "example": "INTERNAL_SERVER_ERROR"
                },
                "code": {
                  "type": "number",
                  "example": 4
                }
              }
            }
          }
        }
      },
      "NotFoundError": {
        "description": "المورد المطلوب غير موجود.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "الرابط المختصر غير موجود"
                  ]
                },
                "errorCode": {
                  "type": "string",
                  "example": "NOT_FOUND"
                },
                "code": {
                  "type": "number",
                  "example": 6
                }
              }
            }
          }
        }
      },
      "ConflictError": {
        "description": "الطلب يتعارض مع الحالة الحالية للمورد.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "هذا الاسم المستعار غير متاح"
                  ]
                },
                "errorCode": {
                  "type": "string",
                  "example": "CONFLICT"
                },
                "code": {
                  "type": "number",
                  "example": 7
                }
              }
            }
          }
        }
      },
      "ResourceExpiredError": {
        "description": "المورد المطلوب منتهي الصلاحية.",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "data": {
                  "type": "object",
                  "example": {}
                },
                "errors": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "example": [
                    "انتهت صلاحية رمز التحقق"
                  ]
                },
                "errorCode": {
                  "type": "string",
                  "example": "RESOURCE_EXPIRED"
                },
                "code": {
                  "type": "number",
                  "example": 8
                }
              }
            }
          }
        }
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "رمز Bearer للمصادقة"
      }
    }
  },
  "security": [
    {
      "BearerAuth": []
    }
  ]
}